%% given
h = 25; %W/(m^2-C)
Tinf = 800; %C
k = [20; 30; 50]; %W/(m-C)
L = [0.3; 0.15; 0.15]; %m

%% stiffness matrix
Ke = cell(3,1);
kL = k./L;

Ke{1} = [kL(1)+h -kL(1) 0 0; ...
        -kL(1)    kL(1) 0 0; ...
           0        0   0 0; ...
           0        0   0 0];

Ke{2} = [0    0      0   0; ...
         0  kL(2) -kL(2) 0; ...
         0 -kL(2)  kL(2) 0; ...
         0    0      0   0];

Ke{3} = [0 0    0      0; ...
         0 0    0      0; ...
         0 0  kL(3) -kL(3); ...
         0 0 -kL(3)  kL(3)];

K = Ke{1}+Ke{2}+Ke{3};

%% force vector
Fe = cell(3,1);
Fe{1} = [h*Tinf; 0; 0; 0];
Fe{2} = [0; 0; 0; 0];
Fe{3} = [0; 0; 0; 0];
F = Fe{1}+Fe{2}+Fe{3};

%% solution
Kr = K(1:3,1:3);
Fr = F(1:3)-K(1:3,4)*20;
T = [Kr^-1*Fr; 20];
q = [0; 0; 0; K(4,:)*T-F(4)];